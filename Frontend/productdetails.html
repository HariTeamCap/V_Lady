<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>V Lady - Product Details</title>
  <link rel="stylesheet" href="productdetails.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
</head>
<body>
  <header>
    <div class="logo">
      V LADY
      <div class="tagline">Versatile Lady</div>
    </div>
    <nav>
      <ul class="nav-links">
        <li><a href="mainpage.html"><i class="fa fa-house-chimney"></i></a></li>
        <li><a href="about.html"><i class="fa fa-circle-info"></i></a></li>
        <li><a href="cart.html"><i class="fa-solid fa-cart-shopping"></i></a></li>
        <li><a href="mainpage.html"><i class="fa fa-envelope"></i></a></li>
      </ul>
    </nav>
  </header>

  <div class="pink-banner">
    <div class="scrolling-text">THE LADY WHO LEADS</div>
  </div>

  <div class="product-page">
    <div class="gallery">
      <div class="main-image">
        <img id="main-img" src="" alt="Product">
        <i id="wishlist-btn" class="fa-regular fa-heart wishlist-icon"></i>
      </div>

      <!-- Thumbnails Section -->
      <div class="thumbnail-container" id="thumbnails">
        <!-- Optional manual thumbnails -->
        <img id="thumb1" class="thumbnail extra" src="IMG_6724.png" alt="Extra Image 1">
        <img id="thumb2" class="thumbnail extra" src="IMG_6725.PNG" alt="Extra Image 2">
        <img id="thumb3" class="thumbnail extra" src="IMG_6727.PNG" alt="Extra Image 3">
      </div>
    </div>

    <div class="details">
      <h1 class="product-title"></h1>
      <p class="price"></p>
      <p class="mrp" id="mrp-text"></p>
      <p id="sold-out-text" style="color:red;font-weight:bold;"></p>
      <p class="description"></p>

      <div class="extra-description" id="extra-desc">
        Discover the perfect fusion of sophistication and practicality with our V LADY handbag.
      </div>

      <div class="btn-group">
        <button class="btn add-cart">Add to Cart</button>
        <button class="btn buy-now">Buy Now</button>
      </div>
    </div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const product = JSON.parse(localStorage.getItem("selectedProduct"));
  if (!product) { 
    // Redirect if no product is found
    window.location.href = "All_Handbags.html"; 
    return; 
  }

  // ===== POPULATE PRODUCT DETAILS =====
  document.querySelector(".product-title").textContent = product.name;
  document.querySelector(".price").textContent = `â‚¹${product.price}`;
  document.querySelector("#mrp-text").textContent = product.MRP ? `MRP: â‚¹${product.MRP}` : "";
  document.querySelector(".description").textContent = product.description || "No description available.";

  const mainImg = document.getElementById("main-img");
  const thumbsContainer = document.getElementById("thumbnails");
  thumbsContainer.innerHTML = ""; // Clear any manual thumbnails

  // ===== BUILD IMAGE GALLERY =====
  if (product.images && product.images.length > 0) {
    // Set the main image to the first image in the array
    mainImg.src = product.images[0];

    // Create a thumbnail for each image
    product.images.forEach((imageUrl, index) => {
      const thumb = document.createElement("img");
      thumb.src = imageUrl;
      thumb.classList.add("thumbnail");
      if (index === 0) {
        thumb.classList.add("active");
      }

      // Add click event to change main image
      thumb.addEventListener("click", () => {
        mainImg.src = imageUrl;
        // Update active state
        document.querySelector(".thumbnail.active")?.classList.remove("active");
        thumb.classList.add("active");
      });

      thumbsContainer.appendChild(thumb);
    });
  } else {
    // Fallback if no images are available
    mainImg.src = 'placeholder.jpg';
  }

  // ===== WISHLIST FUNCTIONALITY =====
  const wishlistBtn = document.getElementById("wishlist-btn");
  let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
  const productId = product._id || `seed_${product.name.replace(/\s/g, '_')}`;

  if (wishlist.find(p => p.id === productId)) {
      wishlistBtn.classList.replace("fa-regular", "fa-solid");
  }

  wishlistBtn.addEventListener("click", () => {
    let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
    const exists = wishlist.find(p => p.id === productId);
    if (exists) {
      wishlist = wishlist.filter(p => p.id !== productId);
      wishlistBtn.classList.replace("fa-solid", "fa-regular");
    } else {
      wishlist.push({ ...product, id: productId });
      wishlistBtn.classList.replace("fa-regular", "fa-solid");
    }
    localStorage.setItem("wishlist", JSON.stringify(wishlist));
  });

  // ===== ADD TO CART & BUY NOW FUNCTIONALITY =====
  const addCartBtn = document.querySelector(".add-cart");
  const buyNowBtn = document.querySelector(".buy-now");

  addCartBtn.addEventListener("click", () => {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const existing = cart.find(p => p.id === productId);
    if (existing) {
      existing.quantity += 1;
    } else {
      cart.push({ ...product, id: productId, quantity: 1 });
    }
    localStorage.setItem("cart", JSON.stringify(cart));
    alert(`${product.name} added to Cart ðŸ›’`);
  });

  buyNowBtn.addEventListener("click", () => {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const existing = cart.find(p => p.id === productId);
    if (!existing) {
      cart.push({ ...product, id: productId, quantity: 1 });
    }
    localStorage.setItem("cart", JSON.stringify(cart));
    window.location.href = "cart.html";
  });
});
</script>
</body>
</html>